nohup: ignoring input
/usr/local/lib/python2.7/dist-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
2018-04-25 06:40:28.531077: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-04-25 06:40:35.040105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: e95e:00:00.0
totalMemory: 11.17GiB freeMemory: 11.10GiB
2018-04-25 06:40:35.040150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: e95e:00:00.0, compute capability: 3.7)
------------------------------
Start training U-net...
generating data list
Train data shape:  2880
Validation data shape:  160
loading data done
got unet
Fitting model...
Epoch 1/10

 1/60 [..............................] - ETA: 23:10 - loss: -0.1422 - dice_coef: 0.5065
 2/60 [>.............................] - ETA: 12:31 - loss: -0.1434 - dice_coef: 0.5066
 3/60 [>.............................] - ETA: 8:56 - loss: -0.1447 - dice_coef: 0.5066 
 4/60 [=>............................] - ETA: 7:07 - loss: -0.1412 - dice_coef: 0.5066
 5/60 [=>............................] - ETA: 6:01 - loss: -0.1430 - dice_coef: 0.5066
 6/60 [==>...........................] - ETA: 5:17 - loss: -0.1448 - dice_coef: 0.5067
 7/60 [==>...........................] - ETA: 4:44 - loss: -0.1444 - dice_coef: 0.5068
 8/60 [===>..........................] - ETA: 4:19 - loss: -0.1442 - dice_coef: 0.5068
 9/60 [===>..........................] - ETA: 3:59 - loss: -0.1439 - dice_coef: 0.5069
10/60 [====>.........................] - ETA: 3:43 - loss: -0.1446 - dice_coef: 0.5069
11/60 [====>.........................] - ETA: 3:29 - loss: -0.1440 - dice_coef: 0.5070
12/60 [=====>........................] - ETA: 3:17 - loss: -0.1442 - dice_coef: 0.5070
13/60 [=====>........................] - ETA: 3:06 - loss: -0.1437 - dice_coef: 0.5071
14/60 [======>.......................] - ETA: 2:57 - loss: -0.1434 - dice_coef: 0.5071
15/60 [======>.......................] - ETA: 2:49 - loss: -0.1435 - dice_coef: 0.5072
16/60 [=======>......................] - ETA: 2:41 - loss: -0.1437 - dice_coef: 0.5072
17/60 [=======>......................] - ETA: 2:34 - loss: -0.1437 - dice_coef: 0.5073
18/60 [========>.....................] - ETA: 2:27 - loss: -0.1435 - dice_coef: 0.5073
19/60 [========>.....................] - ETA: 2:21 - loss: -0.1433 - dice_coef: 0.5074
20/60 [=========>....................] - ETA: 2:16 - loss: -0.1435 - dice_coef: 0.5075
21/60 [=========>....................] - ETA: 2:10 - loss: -0.1427 - dice_coef: 0.5075
22/60 [==========>...................] - ETA: 2:05 - loss: -0.1425 - dice_coef: 0.5076
23/60 [==========>...................] - ETA: 2:00 - loss: -0.1425 - dice_coef: 0.5076
24/60 [===========>..................] - ETA: 1:56 - loss: -0.1423 - dice_coef: 0.5077
25/60 [===========>..................] - ETA: 1:51 - loss: -0.1424 - dice_coef: 0.5078
26/60 [============>.................] - ETA: 1:47 - loss: -0.1422 - dice_coef: 0.5078
27/60 [============>.................] - ETA: 1:43 - loss: -0.1420 - dice_coef: 0.5079
28/60 [=============>................] - ETA: 1:39 - loss: -0.1420 - dice_coef: 0.5080
29/60 [=============>................] - ETA: 1:35 - loss: -0.1421 - dice_coef: 0.5080
30/60 [==============>...............] - ETA: 1:31 - loss: -0.1424 - dice_coef: 0.5081
31/60 [==============>...............] - ETA: 1:27 - loss: -0.1423 - dice_coef: 0.5082
32/60 [===============>..............] - ETA: 1:24 - loss: -0.1426 - dice_coef: 0.5083
33/60 [===============>..............] - ETA: 1:20 - loss: -0.1428 - dice_coef: 0.5083
34/60 [================>.............] - ETA: 1:17 - loss: -0.1432 - dice_coef: 0.5084
35/60 [================>.............] - ETA: 1:13 - loss: -0.1431 - dice_coef: 0.5085
36/60 [=================>............] - ETA: 1:10 - loss: -0.1430 - dice_coef: 0.5086
37/60 [=================>............] - ETA: 1:07 - loss: -0.1432 - dice_coef: 0.5087
38/60 [==================>...........] - ETA: 1:04 - loss: -0.1434 - dice_coef: 0.5088
39/60 [==================>...........] - ETA: 1:00 - loss: -0.1432 - dice_coef: 0.5089
40/60 [===================>..........] - ETA: 57s - loss: -0.1433 - dice_coef: 0.5090 
41/60 [===================>..........] - ETA: 54s - loss: -0.1436 - dice_coef: 0.5091
42/60 [====================>.........] - ETA: 51s - loss: -0.1436 - dice_coef: 0.5093
43/60 [====================>.........] - ETA: 48s - loss: -0.1437 - dice_coef: 0.5094
44/60 [=====================>........] - ETA: 45s - loss: -0.1436 - dice_coef: 0.5095
45/60 [=====================>........] - ETA: 42s - loss: -0.1438 - dice_coef: 0.5096
46/60 [======================>.......] - ETA: 39s - loss: -0.1439 - dice_coef: 0.5097
47/60 [======================>.......] - ETA: 36s - loss: -0.1438 - dice_coef: 0.5098
48/60 [=======================>......] - ETA: 33s - loss: -0.1440 - dice_coef: 0.5100
49/60 [=======================>......] - ETA: 30s - loss: -0.1438 - dice_coef: 0.5101
50/60 [========================>.....] - ETA: 27s - loss: -0.1439 - dice_coef: 0.5102
51/60 [========================>.....] - ETA: 24s - loss: -0.1439 - dice_coef: 0.5103
52/60 [=========================>....] - ETA: 22s - loss: -0.1443 - dice_coef: 0.5104
53/60 [=========================>....] - ETA: 19s - loss: -0.1445 - dice_coef: 0.5106
54/60 [==========================>...] - ETA: 16s - loss: -0.1446 - dice_coef: 0.5107
55/60 [==========================>...] - ETA: 13s - loss: -0.1446 - dice_coef: 0.5108
56/60 [===========================>..] - ETA: 10s - loss: -0.1447 - dice_coef: 0.5109
57/60 [===========================>..] - ETA: 8s - loss: -0.1448 - dice_coef: 0.5111 
58/60 [============================>.] - ETA: 5s - loss: -0.1450 - dice_coef: 0.5112
59/60 [============================>.] - ETA: 2s - loss: -0.1452 - dice_coef: 0.5113
60/60 [==============================] - 165s 3s/step - loss: -0.1454 - dice_coef: 0.5114 - val_loss: -0.1438 - val_dice_coef: 0.5206

Epoch 00001: loss improved from inf to -0.14542, saving model to unet_brain.h5
Epoch 2/10

 1/60 [..............................] - ETA: 2:19 - loss: -0.1641 - dice_coef: 0.5198
 2/60 [>.............................] - ETA: 2:17 - loss: -0.1608 - dice_coef: 0.5195
 3/60 [>.............................] - ETA: 2:15 - loss: -0.1585 - dice_coef: 0.5197
 4/60 [=>............................] - ETA: 2:12 - loss: -0.1610 - dice_coef: 0.5198
 5/60 [=>............................] - ETA: 2:10 - loss: -0.1604 - dice_coef: 0.5202
 6/60 [==>...........................] - ETA: 2:07 - loss: -0.1599 - dice_coef: 0.5204
 7/60 [==>...........................] - ETA: 2:05 - loss: -0.1618 - dice_coef: 0.5204
 8/60 [===>..........................] - ETA: 2:02 - loss: -0.1608 - dice_coef: 0.5209
 9/60 [===>..........................] - ETA: 2:00 - loss: -0.1624 - dice_coef: 0.5212
10/60 [====>.........................] - ETA: 1:58 - loss: -0.1637 - dice_coef: 0.5214
11/60 [====>.........................] - ETA: 1:56 - loss: -0.1644 - dice_coef: 0.5218
12/60 [=====>........................] - ETA: 1:53 - loss: -0.1646 - dice_coef: 0.5222
13/60 [=====>........................] - ETA: 1:51 - loss: -0.1654 - dice_coef: 0.5226
14/60 [======>.......................] - ETA: 1:49 - loss: -0.1664 - dice_coef: 0.5232
15/60 [======>.......................] - ETA: 1:46 - loss: -0.1678 - dice_coef: 0.5233
16/60 [=======>......................] - ETA: 1:44 - loss: -0.1698 - dice_coef: 0.5237
17/60 [=======>......................] - ETA: 1:42 - loss: -0.1709 - dice_coef: 0.5244
18/60 [========>.....................] - ETA: 1:39 - loss: -0.1714 - dice_coef: 0.5250
19/60 [========>.....................] - ETA: 1:37 - loss: -0.1724 - dice_coef: 0.5257
20/60 [=========>....................] - ETA: 1:35 - loss: -0.1738 - dice_coef: 0.5270
21/60 [=========>....................] - ETA: 1:32 - loss: -0.1753 - dice_coef: 0.5281
22/60 [==========>...................] - ETA: 1:30 - loss: -0.1771 - dice_coef: 0.5295
23/60 [==========>...................] - ETA: 1:28 - loss: -0.1796 - dice_coef: 0.5312
24/60 [===========>..................] - ETA: 1:25 - loss: -0.1809 - dice_coef: 0.5337
25/60 [===========>..................] - ETA: 1:23 - loss: -0.1836 - dice_coef: 0.5366
26/60 [============>.................] - ETA: 1:20 - loss: -0.1859 - dice_coef: 0.5402
27/60 [============>.................] - ETA: 1:18 - loss: -0.1880 - dice_coef: 0.5444
28/60 [=============>................] - ETA: 1:16 - loss: -0.1905 - dice_coef: 0.5492
29/60 [=============>................] - ETA: 1:13 - loss: -0.1932 - dice_coef: 0.5544
30/60 [==============>...............] - ETA: 1:11 - loss: -0.1970 - dice_coef: 0.5598
31/60 [==============>...............] - ETA: 1:08 - loss: -0.2012 - dice_coef: 0.5657
32/60 [===============>..............] - ETA: 1:06 - loss: -0.2055 - dice_coef: 0.5718
33/60 [===============>..............] - ETA: 1:04 - loss: -0.2089 - dice_coef: 0.5787
34/60 [================>.............] - ETA: 1:01 - loss: -0.2141 - dice_coef: 0.5852
35/60 [================>.............] - ETA: 59s - loss: -0.2188 - dice_coef: 0.5923 
36/60 [=================>............] - ETA: 57s - loss: -0.2238 - dice_coef: 0.5987
37/60 [=================>............] - ETA: 54s - loss: -0.2284 - dice_coef: 0.6051
38/60 [==================>...........] - ETA: 52s - loss: -0.2337 - dice_coef: 0.6116
39/60 [==================>...........] - ETA: 49s - loss: -0.2396 - dice_coef: 0.6187
40/60 [===================>..........] - ETA: 47s - loss: -0.2445 - dice_coef: 0.6249
41/60 [===================>..........] - ETA: 45s - loss: -0.2491 - dice_coef: 0.6311
42/60 [====================>.........] - ETA: 42s - loss: -0.2541 - dice_coef: 0.6370
43/60 [====================>.........] - ETA: 40s - loss: -0.2597 - dice_coef: 0.6427
44/60 [=====================>........] - ETA: 38s - loss: -0.2649 - dice_coef: 0.6483
45/60 [=====================>........] - ETA: 35s - loss: -0.2694 - dice_coef: 0.6536
46/60 [======================>.......] - ETA: 33s - loss: -0.2746 - dice_coef: 0.6591
47/60 [======================>.......] - ETA: 30s - loss: -0.2797 - dice_coef: 0.6644
48/60 [=======================>......] - ETA: 28s - loss: -0.2841 - dice_coef: 0.6689
49/60 [=======================>......] - ETA: 26s - loss: -0.2887 - dice_coef: 0.6736
50/60 [========================>.....] - ETA: 23s - loss: -0.2926 - dice_coef: 0.6779
51/60 [========================>.....] - ETA: 21s - loss: -0.2970 - dice_coef: 0.6823
52/60 [=========================>....] - ETA: 19s - loss: -0.3010 - dice_coef: 0.6867
53/60 [=========================>....] - ETA: 16s - loss: -0.3052 - dice_coef: 0.6909
54/60 [==========================>...] - ETA: 14s - loss: -0.3086 - dice_coef: 0.6945
55/60 [==========================>...] - ETA: 11s - loss: -0.3127 - dice_coef: 0.6985
56/60 [===========================>..] - ETA: 9s - loss: -0.3166 - dice_coef: 0.7024 
57/60 [===========================>..] - ETA: 7s - loss: -0.3201 - dice_coef: 0.7060
58/60 [============================>.] - ETA: 4s - loss: -0.3234 - dice_coef: 0.7094
59/60 [============================>.] - ETA: 2s - loss: -0.3266 - dice_coef: 0.7127
60/60 [==============================] - 145s 2s/step - loss: -0.3298 - dice_coef: 0.7157 - val_loss: -0.5265 - val_dice_coef: 0.9181

Epoch 00002: loss improved from -0.14542 to -0.32983, saving model to unet_brain.h5
Epoch 3/10

 1/60 [..............................] - ETA: 2:19 - loss: -0.5279 - dice_coef: 0.9155
 2/60 [>.............................] - ETA: 2:17 - loss: -0.5232 - dice_coef: 0.9122
 3/60 [>.............................] - ETA: 2:15 - loss: -0.5276 - dice_coef: 0.9112
 4/60 [=>............................] - ETA: 2:13 - loss: -0.5323 - dice_coef: 0.9128
 5/60 [=>............................] - ETA: 2:10 - loss: -0.5279 - dice_coef: 0.9122
 6/60 [==>...........................] - ETA: 2:08 - loss: -0.5293 - dice_coef: 0.91112018-04-25 06:45:55.240290: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 3.38GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
2018-04-25 06:45:55.240341: W tensorflow/stream_executor/cuda/cuda_dnn.cc:2223] 
2018-04-25 06:45:56.090318: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 3.38GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
2018-04-25 06:45:56.090375: W tensorflow/stream_executor/cuda/cuda_dnn.cc:3355] 

 7/60 [==>...........................] - ETA: 2:07 - loss: -0.5320 - dice_coef: 0.9134
 8/60 [===>..........................] - ETA: 2:04 - loss: -0.5292 - dice_coef: 0.9128
 9/60 [===>..........................] - ETA: 2:02 - loss: -0.5302 - dice_coef: 0.9127
10/60 [====>.........................] - ETA: 1:59 - loss: -0.5295 - dice_coef: 0.9126
11/60 [====>.........................] - ETA: 1:57 - loss: -0.5277 - dice_coef: 0.9120
12/60 [=====>........................] - ETA: 1:55 - loss: -0.5279 - dice_coef: 0.9107
13/60 [=====>........................] - ETA: 1:52 - loss: -0.5304 - dice_coef: 0.9106
14/60 [======>.......................] - ETA: 1:50 - loss: -0.5303 - dice_coef: 0.9108
15/60 [======>.......................] - ETA: 1:47 - loss: -0.5277 - dice_coef: 0.9090
16/60 [=======>......................] - ETA: 1:45 - loss: -0.5301 - dice_coef: 0.9096
17/60 [=======>......................] - ETA: 1:42 - loss: -0.5298 - dice_coef: 0.9091
18/60 [========>.....................] - ETA: 1:40 - loss: -0.5306 - dice_coef: 0.9106
19/60 [========>.....................] - ETA: 1:38 - loss: -0.5299 - dice_coef: 0.9099
20/60 [=========>....................] - ETA: 1:35 - loss: -0.5309 - dice_coef: 0.9099
21/60 [=========>....................] - ETA: 1:33 - loss: -0.5311 - dice_coef: 0.9098
22/60 [==========>...................] - ETA: 1:30 - loss: -0.5310 - dice_coef: 0.9101
23/60 [==========>...................] - ETA: 1:28 - loss: -0.5306 - dice_coef: 0.9101
24/60 [===========>..................] - ETA: 1:26 - loss: -0.5316 - dice_coef: 0.9105
25/60 [===========>..................] - ETA: 1:23 - loss: -0.5317 - dice_coef: 0.9105
26/60 [============>.................] - ETA: 1:21 - loss: -0.5318 - dice_coef: 0.9106
27/60 [============>.................] - ETA: 1:18 - loss: -0.5320 - dice_coef: 0.9107
28/60 [=============>................] - ETA: 1:16 - loss: -0.5331 - dice_coef: 0.9112
29/60 [=============>................] - ETA: 1:14 - loss: -0.5339 - dice_coef: 0.9116
30/60 [==============>...............] - ETA: 1:11 - loss: -0.5347 - dice_coef: 0.9116
31/60 [==============>...............] - ETA: 1:09 - loss: -0.5348 - dice_coef: 0.9120
32/60 [===============>..............] - ETA: 1:06 - loss: -0.5355 - dice_coef: 0.9118
33/60 [===============>..............] - ETA: 1:04 - loss: -0.5356 - dice_coef: 0.9120
34/60 [================>.............] - ETA: 1:02 - loss: -0.5359 - dice_coef: 0.9118
35/60 [================>.............] - ETA: 59s - loss: -0.5361 - dice_coef: 0.9117 
36/60 [=================>............] - ETA: 57s - loss: -0.5359 - dice_coef: 0.9115
37/60 [=================>............] - ETA: 54s - loss: -0.5360 - dice_coef: 0.9114
38/60 [==================>...........] - ETA: 52s - loss: -0.5362 - dice_coef: 0.9113
39/60 [==================>...........] - ETA: 50s - loss: -0.5363 - dice_coef: 0.9114
40/60 [===================>..........] - ETA: 47s - loss: -0.5369 - dice_coef: 0.9118
41/60 [===================>..........] - ETA: 45s - loss: -0.5367 - dice_coef: 0.9115
42/60 [====================>.........] - ETA: 42s - loss: -0.5367 - dice_coef: 0.9117
43/60 [====================>.........] - ETA: 40s - loss: -0.5371 - dice_coef: 0.9119
44/60 [=====================>........] - ETA: 38s - loss: -0.5374 - dice_coef: 0.9120
45/60 [=====================>........] - ETA: 35s - loss: -0.5373 - dice_coef: 0.9120
46/60 [======================>.......] - ETA: 33s - loss: -0.5379 - dice_coef: 0.9122
47/60 [======================>.......] - ETA: 31s - loss: -0.5379 - dice_coef: 0.9125
48/60 [=======================>......] - ETA: 28s - loss: -0.5377 - dice_coef: 0.9124
49/60 [=======================>......] - ETA: 26s - loss: -0.5379 - dice_coef: 0.9126
50/60 [========================>.....] - ETA: 23s - loss: -0.5385 - dice_coef: 0.9127
51/60 [========================>.....] - ETA: 21s - loss: -0.5385 - dice_coef: 0.9126
52/60 [=========================>....] - ETA: 19s - loss: -0.5395 - dice_coef: 0.91292018-04-25 06:47:45.754103: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 3.38GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
2018-04-25 06:47:45.754159: W tensorflow/stream_executor/cuda/cuda_dnn.cc:3355] 

53/60 [=========================>....] - ETA: 16s - loss: -0.5399 - dice_coef: 0.9131
54/60 [==========================>...] - ETA: 14s - loss: -0.5402 - dice_coef: 0.9131
55/60 [==========================>...] - ETA: 11s - loss: -0.5402 - dice_coef: 0.9129
56/60 [===========================>..] - ETA: 9s - loss: -0.5407 - dice_coef: 0.9131 
57/60 [===========================>..] - ETA: 7s - loss: -0.5411 - dice_coef: 0.9132
58/60 [============================>.] - ETA: 4s - loss: -0.5411 - dice_coef: 0.9133
59/60 [============================>.] - ETA: 2s - loss: -0.5412 - dice_coef: 0.9133
60/60 [==============================] - 146s 2s/step - loss: -0.5416 - dice_coef: 0.9135 - val_loss: -0.5540 - val_dice_coef: 0.9336

Epoch 00003: loss improved from -0.32983 to -0.54158, saving model to unet_brain.h5
Epoch 4/10

 1/60 [..............................] - ETA: 2:20 - loss: -0.5261 - dice_coef: 0.9177
 2/60 [>.............................] - ETA: 2:17 - loss: -0.5328 - dice_coef: 0.9166
 3/60 [>.............................] - ETA: 2:15 - loss: -0.5343 - dice_coef: 0.9159
 4/60 [=>............................] - ETA: 2:13 - loss: -0.5398 - dice_coef: 0.9189
 5/60 [=>............................] - ETA: 2:10 - loss: -0.5414 - dice_coef: 0.9213
 6/60 [==>...........................] - ETA: 2:08 - loss: -0.5451 - dice_coef: 0.9214
 7/60 [==>...........................] - ETA: 2:06 - loss: -0.5500 - dice_coef: 0.9227
 8/60 [===>..........................] - ETA: 2:03 - loss: -0.5499 - dice_coef: 0.9252
 9/60 [===>..........................] - ETA: 2:01 - loss: -0.5499 - dice_coef: 0.9246
10/60 [====>.........................] - ETA: 1:59 - loss: -0.5481 - dice_coef: 0.9212
11/60 [====>.........................] - ETA: 1:56 - loss: -0.5482 - dice_coef: 0.9213
12/60 [=====>........................] - ETA: 1:54 - loss: -0.5478 - dice_coef: 0.9226
13/60 [=====>........................] - ETA: 1:51 - loss: -0.5509 - dice_coef: 0.9238
14/60 [======>.......................] - ETA: 1:49 - loss: -0.5493 - dice_coef: 0.9217
15/60 [======>.......................] - ETA: 1:47 - loss: -0.5471 - dice_coef: 0.9208
16/60 [=======>......................] - ETA: 1:44 - loss: -0.5472 - dice_coef: 0.9207
17/60 [=======>......................] - ETA: 1:42 - loss: -0.5495 - dice_coef: 0.9223
18/60 [========>.....................] - ETA: 1:40 - loss: -0.5504 - dice_coef: 0.9234
19/60 [========>.....................] - ETA: 1:37 - loss: -0.5507 - dice_coef: 0.9232
20/60 [=========>....................] - ETA: 1:35 - loss: -0.5490 - dice_coef: 0.9222
21/60 [=========>....................] - ETA: 1:32 - loss: -0.5490 - dice_coef: 0.9224
22/60 [==========>...................] - ETA: 1:30 - loss: -0.5499 - dice_coef: 0.9232
23/60 [==========>...................] - ETA: 1:28 - loss: -0.5492 - dice_coef: 0.9241
24/60 [===========>..................] - ETA: 1:25 - loss: -0.5516 - dice_coef: 0.9249
25/60 [===========>..................] - ETA: 1:23 - loss: -0.5509 - dice_coef: 0.9238
26/60 [============>.................] - ETA: 1:21 - loss: -0.5508 - dice_coef: 0.9234
27/60 [============>.................] - ETA: 1:18 - loss: -0.5516 - dice_coef: 0.9241
28/60 [=============>................] - ETA: 1:16 - loss: -0.5520 - dice_coef: 0.9246
29/60 [=============>................] - ETA: 1:13 - loss: -0.5522 - dice_coef: 0.9248
30/60 [==============>...............] - ETA: 1:11 - loss: -0.5516 - dice_coef: 0.9242
31/60 [==============>...............] - ETA: 1:09 - loss: -0.5526 - dice_coef: 0.9246
32/60 [===============>..............] - ETA: 1:06 - loss: -0.5528 - dice_coef: 0.9248
33/60 [===============>..............] - ETA: 1:04 - loss: -0.5533 - dice_coef: 0.9251
34/60 [================>.............] - ETA: 1:01 - loss: -0.5536 - dice_coef: 0.9250
35/60 [================>.............] - ETA: 59s - loss: -0.5543 - dice_coef: 0.9252 
36/60 [=================>............] - ETA: 57s - loss: -0.5550 - dice_coef: 0.9254
37/60 [=================>............] - ETA: 54s - loss: -0.5560 - dice_coef: 0.9256
38/60 [==================>...........] - ETA: 52s - loss: -0.5567 - dice_coef: 0.9257
39/60 [==================>...........] - ETA: 50s - loss: -0.5575 - dice_coef: 0.9257
40/60 [===================>..........] - ETA: 47s - loss: -0.5588 - dice_coef: 0.9263
41/60 [===================>..........] - ETA: 45s - loss: -0.5598 - dice_coef: 0.9268
42/60 [====================>.........] - ETA: 42s - loss: -0.5602 - dice_coef: 0.9269
43/60 [====================>.........] - ETA: 40s - loss: -0.5608 - dice_coef: 0.9270
44/60 [=====================>........] - ETA: 38s - loss: -0.5615 - dice_coef: 0.9270
45/60 [=====================>........] - ETA: 35s - loss: -0.5623 - dice_coef: 0.9272
46/60 [======================>.......] - ETA: 33s - loss: -0.5622 - dice_coef: 0.9273
47/60 [======================>.......] - ETA: 30s - loss: -0.5624 - dice_coef: 0.9275
48/60 [=======================>......] - ETA: 28s - loss: -0.5627 - dice_coef: 0.9277
49/60 [=======================>......] - ETA: 26s - loss: -0.5629 - dice_coef: 0.9277
50/60 [========================>.....] - ETA: 23s - loss: -0.5633 - dice_coef: 0.9277
51/60 [========================>.....] - ETA: 21s - loss: -0.5634 - dice_coef: 0.9279
52/60 [=========================>....] - ETA: 19s - loss: -0.5638 - dice_coef: 0.9281
53/60 [=========================>....] - ETA: 16s - loss: -0.5644 - dice_coef: 0.9283
54/60 [==========================>...] - ETA: 14s - loss: -0.5647 - dice_coef: 0.9287
55/60 [==========================>...] - ETA: 11s - loss: -0.5654 - dice_coef: 0.9288
56/60 [===========================>..] - ETA: 9s - loss: -0.5659 - dice_coef: 0.9290 
57/60 [===========================>..] - ETA: 7s - loss: -0.5663 - dice_coef: 0.9292
58/60 [============================>.] - ETA: 4s - loss: -0.5670 - dice_coef: 0.9293
59/60 [============================>.] - ETA: 2s - loss: -0.5671 - dice_coef: 0.9295
60/60 [==============================] - 145s 2s/step - loss: -0.5672 - dice_coef: 0.9296 - val_loss: -0.6004 - val_dice_coef: 0.9447

Epoch 00004: loss improved from -0.54158 to -0.56720, saving model to unet_brain.h5
Epoch 5/10

 1/60 [..............................] - ETA: 2:19 - loss: -0.5910 - dice_coef: 0.9322
 2/60 [>.............................] - ETA: 2:17 - loss: -0.5903 - dice_coef: 0.93332018-04-25 06:50:38.730461: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 3.38GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
2018-04-25 06:50:38.730513: W tensorflow/stream_executor/cuda/cuda_dnn.cc:3355] 

 3/60 [>.............................] - ETA: 2:16 - loss: -0.5852 - dice_coef: 0.9343
 4/60 [=>............................] - ETA: 2:14 - loss: -0.5890 - dice_coef: 0.9350
 5/60 [=>............................] - ETA: 2:11 - loss: -0.5856 - dice_coef: 0.9311
 6/60 [==>...........................] - ETA: 2:09 - loss: -0.5872 - dice_coef: 0.9339
 7/60 [==>...........................] - ETA: 2:06 - loss: -0.5873 - dice_coef: 0.9340
 8/60 [===>..........................] - ETA: 2:04 - loss: -0.5850 - dice_coef: 0.9339
 9/60 [===>..........................] - ETA: 2:01 - loss: -0.5875 - dice_coef: 0.9343
10/60 [====>.........................] - ETA: 1:59 - loss: -0.5892 - dice_coef: 0.9362
11/60 [====>.........................] - ETA: 1:56 - loss: -0.5908 - dice_coef: 0.9368
12/60 [=====>........................] - ETA: 1:54 - loss: -0.5904 - dice_coef: 0.9369
13/60 [=====>........................] - ETA: 1:52 - loss: -0.5923 - dice_coef: 0.9370
14/60 [======>.......................] - ETA: 1:49 - loss: -0.5930 - dice_coef: 0.9380
15/60 [======>.......................] - ETA: 1:47 - loss: -0.5936 - dice_coef: 0.9385
16/60 [=======>......................] - ETA: 1:44 - loss: -0.5930 - dice_coef: 0.9381
17/60 [=======>......................] - ETA: 1:42 - loss: -0.5922 - dice_coef: 0.9377
18/60 [========>.....................] - ETA: 1:40 - loss: -0.5927 - dice_coef: 0.9385
19/60 [========>.....................] - ETA: 1:37 - loss: -0.5942 - dice_coef: 0.9388
20/60 [=========>....................] - ETA: 1:35 - loss: -0.5930 - dice_coef: 0.9382
21/60 [=========>....................] - ETA: 1:33 - loss: -0.5936 - dice_coef: 0.9382
22/60 [==========>...................] - ETA: 1:30 - loss: -0.5926 - dice_coef: 0.9384
23/60 [==========>...................] - ETA: 1:28 - loss: -0.5929 - dice_coef: 0.9383
24/60 [===========>..................] - ETA: 1:25 - loss: -0.5919 - dice_coef: 0.9376
25/60 [===========>..................] - ETA: 1:23 - loss: -0.5924 - dice_coef: 0.9378
26/60 [============>.................] - ETA: 1:21 - loss: -0.5921 - dice_coef: 0.9381
27/60 [============>.................] - ETA: 1:18 - loss: -0.5921 - dice_coef: 0.9383
28/60 [=============>................] - ETA: 1:16 - loss: -0.5929 - dice_coef: 0.9385
29/60 [=============>................] - ETA: 1:13 - loss: -0.5940 - dice_coef: 0.9388
30/60 [==============>...............] - ETA: 1:11 - loss: -0.5947 - dice_coef: 0.9392
31/60 [==============>...............] - ETA: 1:09 - loss: -0.5949 - dice_coef: 0.9395
32/60 [===============>..............] - ETA: 1:06 - loss: -0.5958 - dice_coef: 0.9397
33/60 [===============>..............] - ETA: 1:04 - loss: -0.5964 - dice_coef: 0.9398
34/60 [================>.............] - ETA: 1:01 - loss: -0.5971 - dice_coef: 0.9400
35/60 [================>.............] - ETA: 59s - loss: -0.5969 - dice_coef: 0.9402 
36/60 [=================>............] - ETA: 57s - loss: -0.5975 - dice_coef: 0.9401
37/60 [=================>............] - ETA: 54s - loss: -0.5974 - dice_coef: 0.9399
38/60 [==================>...........] - ETA: 52s - loss: -0.5976 - dice_coef: 0.9397
39/60 [==================>...........] - ETA: 50s - loss: -0.5971 - dice_coef: 0.9399
40/60 [===================>..........] - ETA: 47s - loss: -0.5976 - dice_coef: 0.9399
41/60 [===================>..........] - ETA: 45s - loss: -0.5977 - dice_coef: 0.9398
42/60 [====================>.........] - ETA: 42s - loss: -0.5978 - dice_coef: 0.9399
43/60 [====================>.........] - ETA: 40s - loss: -0.5981 - dice_coef: 0.9400
44/60 [=====================>........] - ETA: 38s - loss: -0.5986 - dice_coef: 0.9402
45/60 [=====================>........] - ETA: 35s - loss: -0.5988 - dice_coef: 0.9402
46/60 [======================>.......] - ETA: 33s - loss: -0.5989 - dice_coef: 0.9402
47/60 [======================>.......] - ETA: 30s - loss: -0.5987 - dice_coef: 0.9402
48/60 [=======================>......] - ETA: 28s - loss: -0.5987 - dice_coef: 0.9402
49/60 [=======================>......] - ETA: 26s - loss: -0.5987 - dice_coef: 0.9401
50/60 [========================>.....] - ETA: 23s - loss: -0.5990 - dice_coef: 0.9402
51/60 [========================>.....] - ETA: 21s - loss: -0.5991 - dice_coef: 0.9402
52/60 [=========================>....] - ETA: 19s - loss: -0.5993 - dice_coef: 0.9402
53/60 [=========================>....] - ETA: 16s - loss: -0.5992 - dice_coef: 0.9403
54/60 [==========================>...] - ETA: 14s - loss: -0.5989 - dice_coef: 0.9402
55/60 [==========================>...] - ETA: 11s - loss: -0.5991 - dice_coef: 0.9402
56/60 [===========================>..] - ETA: 9s - loss: -0.5991 - dice_coef: 0.9402 
57/60 [===========================>..] - ETA: 7s - loss: -0.5994 - dice_coef: 0.9403
58/60 [============================>.] - ETA: 4s - loss: -0.5996 - dice_coef: 0.9403
59/60 [============================>.] - ETA: 2s - loss: -0.5999 - dice_coef: 0.9405
60/60 [==============================] - 146s 2s/step - loss: -0.6000 - dice_coef: 0.9406 - val_loss: -0.6276 - val_dice_coef: 0.9480

Epoch 00005: loss improved from -0.56720 to -0.60005, saving model to unet_brain.h5
Epoch 6/10

 1/60 [..............................] - ETA: 2:20 - loss: -0.6079 - dice_coef: 0.9404
 2/60 [>.............................] - ETA: 2:18 - loss: -0.5990 - dice_coef: 0.9386
 3/60 [>.............................] - ETA: 2:15 - loss: -0.6012 - dice_coef: 0.9401
 4/60 [=>............................] - ETA: 2:13 - loss: -0.6056 - dice_coef: 0.9431
 5/60 [=>............................] - ETA: 2:11 - loss: -0.6067 - dice_coef: 0.9418
 6/60 [==>...........................] - ETA: 2:08 - loss: -0.6102 - dice_coef: 0.9438
 7/60 [==>...........................] - ETA: 2:06 - loss: -0.6121 - dice_coef: 0.9438
 8/60 [===>..........................] - ETA: 2:03 - loss: -0.6137 - dice_coef: 0.9438
 9/60 [===>..........................] - ETA: 2:01 - loss: -0.6123 - dice_coef: 0.9429
10/60 [====>.........................] - ETA: 1:59 - loss: -0.6112 - dice_coef: 0.9429
11/60 [====>.........................] - ETA: 1:56 - loss: -0.6090 - dice_coef: 0.9435
12/60 [=====>........................] - ETA: 1:54 - loss: -0.6102 - dice_coef: 0.9431
13/60 [=====>........................] - ETA: 1:51 - loss: -0.6111 - dice_coef: 0.9425
14/60 [======>.......................] - ETA: 1:49 - loss: -0.6105 - dice_coef: 0.9421
15/60 [======>.......................] - ETA: 1:47 - loss: -0.6119 - dice_coef: 0.9432
16/60 [=======>......................] - ETA: 1:44 - loss: -0.6130 - dice_coef: 0.9434
17/60 [=======>......................] - ETA: 1:42 - loss: -0.6126 - dice_coef: 0.9435
18/60 [========>.....................] - ETA: 1:40 - loss: -0.6127 - dice_coef: 0.9439
19/60 [========>.....................] - ETA: 1:37 - loss: -0.6123 - dice_coef: 0.9438
20/60 [=========>....................] - ETA: 1:35 - loss: -0.6127 - dice_coef: 0.9437
21/60 [=========>....................] - ETA: 1:32 - loss: -0.6127 - dice_coef: 0.9434
22/60 [==========>...................] - ETA: 1:30 - loss: -0.6128 - dice_coef: 0.9434
23/60 [==========>...................] - ETA: 1:28 - loss: -0.6126 - dice_coef: 0.9431
24/60 [===========>..................] - ETA: 1:25 - loss: -0.6131 - dice_coef: 0.9433
25/60 [===========>..................] - ETA: 1:23 - loss: -0.6133 - dice_coef: 0.9431
26/60 [============>.................] - ETA: 1:21 - loss: -0.6131 - dice_coef: 0.9433
27/60 [============>.................] - ETA: 1:18 - loss: -0.6135 - dice_coef: 0.9433
28/60 [=============>................] - ETA: 1:16 - loss: -0.6136 - dice_coef: 0.9434
29/60 [=============>................] - ETA: 1:13 - loss: -0.6143 - dice_coef: 0.9434
30/60 [==============>...............] - ETA: 1:11 - loss: -0.6142 - dice_coef: 0.9435
31/60 [==============>...............] - ETA: 1:09 - loss: -0.6140 - dice_coef: 0.9436
32/60 [===============>..............] - ETA: 1:06 - loss: -0.6147 - dice_coef: 0.9437
33/60 [===============>..............] - ETA: 1:04 - loss: -0.6140 - dice_coef: 0.9437
34/60 [================>.............] - ETA: 1:01 - loss: -0.6137 - dice_coef: 0.9436
35/60 [================>.............] - ETA: 59s - loss: -0.6133 - dice_coef: 0.9433 
36/60 [=================>............] - ETA: 57s - loss: -0.6137 - dice_coef: 0.9434
37/60 [=================>............] - ETA: 54s - loss: -0.6133 - dice_coef: 0.9435
38/60 [==================>...........] - ETA: 52s - loss: -0.6129 - dice_coef: 0.9433
39/60 [==================>...........] - ETA: 50s - loss: -0.6132 - dice_coef: 0.9433
40/60 [===================>..........] - ETA: 47s - loss: -0.6125 - dice_coef: 0.9433
41/60 [===================>..........] - ETA: 45s - loss: -0.6124 - dice_coef: 0.9434
42/60 [====================>.........] - ETA: 42s - loss: -0.6125 - dice_coef: 0.9432
43/60 [====================>.........] - ETA: 40s - loss: -0.6124 - dice_coef: 0.9433
44/60 [=====================>........] - ETA: 38s - loss: -0.6125 - dice_coef: 0.9433
45/60 [=====================>........] - ETA: 35s - loss: -0.6124 - dice_coef: 0.9433
46/60 [======================>.......] - ETA: 33s - loss: -0.6127 - dice_coef: 0.9433
47/60 [======================>.......] - ETA: 30s - loss: -0.6129 - dice_coef: 0.9433
48/60 [=======================>......] - ETA: 28s - loss: -0.6126 - dice_coef: 0.9435
49/60 [=======================>......] - ETA: 26s - loss: -0.6125 - dice_coef: 0.9436
50/60 [========================>.....] - ETA: 23s - loss: -0.6124 - dice_coef: 0.9435
51/60 [========================>.....] - ETA: 21s - loss: -0.6124 - dice_coef: 0.9435
52/60 [=========================>....] - ETA: 19s - loss: -0.6122 - dice_coef: 0.9436
53/60 [=========================>....] - ETA: 16s - loss: -0.6122 - dice_coef: 0.9436
54/60 [==========================>...] - ETA: 14s - loss: -0.6123 - dice_coef: 0.9435
55/60 [==========================>...] - ETA: 11s - loss: -0.6125 - dice_coef: 0.9434
56/60 [===========================>..] - ETA: 9s - loss: -0.6127 - dice_coef: 0.9435 
57/60 [===========================>..] - ETA: 7s - loss: -0.6127 - dice_coef: 0.9436
58/60 [============================>.] - ETA: 4s - loss: -0.6126 - dice_coef: 0.9435
59/60 [============================>.] - ETA: 2s - loss: -0.6128 - dice_coef: 0.9436
60/60 [==============================] - 145s 2s/step - loss: -0.6126 - dice_coef: 0.9435 - val_loss: -0.6283 - val_dice_coef: 0.9557

Epoch 00006: loss improved from -0.60005 to -0.61261, saving model to unet_brain.h5
Epoch 7/10

 1/60 [..............................] - ETA: 2:18 - loss: -0.6104 - dice_coef: 0.9560
 2/60 [>.............................] - ETA: 2:16 - loss: -0.6247 - dice_coef: 0.9502
 3/60 [>.............................] - ETA: 2:14 - loss: -0.6197 - dice_coef: 0.9466
 4/60 [=>............................] - ETA: 2:12 - loss: -0.6223 - dice_coef: 0.9469
 5/60 [=>............................] - ETA: 2:10 - loss: -0.6201 - dice_coef: 0.9481
 6/60 [==>...........................] - ETA: 2:08 - loss: -0.6221 - dice_coef: 0.9491
 7/60 [==>...........................] - ETA: 2:05 - loss: -0.6204 - dice_coef: 0.9487
 8/60 [===>..........................] - ETA: 2:03 - loss: -0.6191 - dice_coef: 0.9485
 9/60 [===>..........................] - ETA: 2:01 - loss: -0.6176 - dice_coef: 0.9494
10/60 [====>.........................] - ETA: 1:58 - loss: -0.6181 - dice_coef: 0.9485
11/60 [====>.........................] - ETA: 1:56 - loss: -0.6169 - dice_coef: 0.9473
12/60 [=====>........................] - ETA: 1:54 - loss: -0.6163 - dice_coef: 0.9477
13/60 [=====>........................] - ETA: 1:51 - loss: -0.6158 - dice_coef: 0.9468
14/60 [======>.......................] - ETA: 1:49 - loss: -0.6155 - dice_coef: 0.9464
15/60 [======>.......................] - ETA: 1:47 - loss: -0.6170 - dice_coef: 0.9470
16/60 [=======>......................] - ETA: 1:44 - loss: -0.6169 - dice_coef: 0.9468
17/60 [=======>......................] - ETA: 1:42 - loss: -0.6182 - dice_coef: 0.9467
18/60 [========>.....................] - ETA: 1:39 - loss: -0.6191 - dice_coef: 0.9468
19/60 [========>.....................] - ETA: 1:37 - loss: -0.6191 - dice_coef: 0.9466
20/60 [=========>....................] - ETA: 1:35 - loss: -0.6194 - dice_coef: 0.9465
21/60 [=========>....................] - ETA: 1:32 - loss: -0.6199 - dice_coef: 0.9463
22/60 [==========>...................] - ETA: 1:30 - loss: -0.6198 - dice_coef: 0.9462
23/60 [==========>...................] - ETA: 1:28 - loss: -0.6189 - dice_coef: 0.9461
24/60 [===========>..................] - ETA: 1:25 - loss: -0.6190 - dice_coef: 0.9460
25/60 [===========>..................] - ETA: 1:23 - loss: -0.6190 - dice_coef: 0.9461
26/60 [============>.................] - ETA: 1:20 - loss: -0.6191 - dice_coef: 0.9461
27/60 [============>.................] - ETA: 1:18 - loss: -0.6194 - dice_coef: 0.9460
28/60 [=============>................] - ETA: 1:16 - loss: -0.6197 - dice_coef: 0.9461
29/60 [=============>................] - ETA: 1:13 - loss: -0.6196 - dice_coef: 0.9463
30/60 [==============>...............] - ETA: 1:11 - loss: -0.6198 - dice_coef: 0.9465
31/60 [==============>...............] - ETA: 1:09 - loss: -0.6197 - dice_coef: 0.9463
32/60 [===============>..............] - ETA: 1:06 - loss: -0.6198 - dice_coef: 0.9461
33/60 [===============>..............] - ETA: 1:04 - loss: -0.6202 - dice_coef: 0.9461
34/60 [================>.............] - ETA: 1:01 - loss: -0.6199 - dice_coef: 0.9456
35/60 [================>.............] - ETA: 59s - loss: -0.6200 - dice_coef: 0.9455 
36/60 [=================>............] - ETA: 57s - loss: -0.6199 - dice_coef: 0.9457
37/60 [=================>............] - ETA: 54s - loss: -0.6194 - dice_coef: 0.9457
38/60 [==================>...........] - ETA: 52s - loss: -0.6195 - dice_coef: 0.9457
39/60 [==================>...........] - ETA: 50s - loss: -0.6196 - dice_coef: 0.9455
40/60 [===================>..........] - ETA: 47s - loss: -0.6201 - dice_coef: 0.9456
41/60 [===================>..........] - ETA: 45s - loss: -0.6193 - dice_coef: 0.9456
42/60 [====================>.........] - ETA: 42s - loss: -0.6190 - dice_coef: 0.9456
43/60 [====================>.........] - ETA: 40s - loss: -0.6187 - dice_coef: 0.9456
44/60 [=====================>........] - ETA: 38s - loss: -0.6187 - dice_coef: 0.9454
45/60 [=====================>........] - ETA: 35s - loss: -0.6187 - dice_coef: 0.9453
46/60 [======================>.......] - ETA: 33s - loss: -0.6185 - dice_coef: 0.9452
47/60 [======================>.......] - ETA: 30s - loss: -0.6187 - dice_coef: 0.9451
48/60 [=======================>......] - ETA: 28s - loss: -0.6187 - dice_coef: 0.9450
49/60 [=======================>......] - ETA: 26s - loss: -0.6188 - dice_coef: 0.9452
50/60 [========================>.....] - ETA: 23s - loss: -0.6188 - dice_coef: 0.9451
51/60 [========================>.....] - ETA: 21s - loss: -0.6190 - dice_coef: 0.9450
52/60 [=========================>....] - ETA: 19s - loss: -0.6192 - dice_coef: 0.9451
53/60 [=========================>....] - ETA: 16s - loss: -0.6193 - dice_coef: 0.9452
54/60 [==========================>...] - ETA: 14s - loss: -0.6196 - dice_coef: 0.9455
55/60 [==========================>...] - ETA: 11s - loss: -0.6195 - dice_coef: 0.9453
56/60 [===========================>..] - ETA: 9s - loss: -0.6198 - dice_coef: 0.9452 
57/60 [===========================>..] - ETA: 7s - loss: -0.6196 - dice_coef: 0.9452
58/60 [============================>.] - ETA: 4s - loss: -0.6199 - dice_coef: 0.9451
59/60 [============================>.] - ETA: 2s - loss: -0.6196 - dice_coef: 0.9448
60/60 [==============================] - 145s 2s/step - loss: -0.6197 - dice_coef: 0.9446 - val_loss: -0.6243 - val_dice_coef: 0.9590

Epoch 00007: loss improved from -0.61261 to -0.61972, saving model to unet_brain.h5
Epoch 8/10

 1/60 [..............................] - ETA: 2:20 - loss: -0.6133 - dice_coef: 0.9497
 2/60 [>.............................] - ETA: 2:18 - loss: -0.6254 - dice_coef: 0.9485
 3/60 [>.............................] - ETA: 2:16 - loss: -0.6203 - dice_coef: 0.9488
 4/60 [=>............................] - ETA: 2:14 - loss: -0.6277 - dice_coef: 0.9489
 5/60 [=>............................] - ETA: 2:11 - loss: -0.6195 - dice_coef: 0.9499
 6/60 [==>...........................] - ETA: 2:09 - loss: -0.6224 - dice_coef: 0.9503
 7/60 [==>...........................] - ETA: 2:06 - loss: -0.6224 - dice_coef: 0.9488
 8/60 [===>..........................] - ETA: 2:04 - loss: -0.6229 - dice_coef: 0.9478
 9/60 [===>..........................] - ETA: 2:01 - loss: -0.6231 - dice_coef: 0.9480
10/60 [====>.........................] - ETA: 1:59 - loss: -0.6230 - dice_coef: 0.9483
11/60 [====>.........................] - ETA: 1:57 - loss: -0.6227 - dice_coef: 0.9478
12/60 [=====>........................] - ETA: 1:54 - loss: -0.6236 - dice_coef: 0.9470
13/60 [=====>........................] - ETA: 1:52 - loss: -0.6231 - dice_coef: 0.9473
14/60 [======>.......................] - ETA: 1:49 - loss: -0.6220 - dice_coef: 0.9473
15/60 [======>.......................] - ETA: 1:47 - loss: -0.6216 - dice_coef: 0.9467
16/60 [=======>......................] - ETA: 1:44 - loss: -0.6209 - dice_coef: 0.9459
17/60 [=======>......................] - ETA: 1:42 - loss: -0.6202 - dice_coef: 0.9454
18/60 [========>.....................] - ETA: 1:40 - loss: -0.6199 - dice_coef: 0.9458
19/60 [========>.....................] - ETA: 1:37 - loss: -0.6204 - dice_coef: 0.9463
20/60 [=========>....................] - ETA: 1:35 - loss: -0.6197 - dice_coef: 0.9455
21/60 [=========>....................] - ETA: 1:32 - loss: -0.6202 - dice_coef: 0.9456
22/60 [==========>...................] - ETA: 1:30 - loss: -0.6203 - dice_coef: 0.9460
23/60 [==========>...................] - ETA: 1:28 - loss: -0.6213 - dice_coef: 0.9462
24/60 [===========>..................] - ETA: 1:25 - loss: -0.6211 - dice_coef: 0.9458
25/60 [===========>..................] - ETA: 1:23 - loss: -0.6209 - dice_coef: 0.9455
26/60 [============>.................] - ETA: 1:21 - loss: -0.6208 - dice_coef: 0.9459
27/60 [============>.................] - ETA: 1:18 - loss: -0.6203 - dice_coef: 0.9459
28/60 [=============>................] - ETA: 1:16 - loss: -0.6202 - dice_coef: 0.9455
29/60 [=============>................] - ETA: 1:13 - loss: -0.6202 - dice_coef: 0.9453
30/60 [==============>...............] - ETA: 1:11 - loss: -0.6204 - dice_coef: 0.9455
31/60 [==============>...............] - ETA: 1:09 - loss: -0.6210 - dice_coef: 0.9458
32/60 [===============>..............] - ETA: 1:06 - loss: -0.6212 - dice_coef: 0.9454
33/60 [===============>..............] - ETA: 1:04 - loss: -0.6216 - dice_coef: 0.9454
34/60 [================>.............] - ETA: 1:02 - loss: -0.6220 - dice_coef: 0.9457
35/60 [================>.............] - ETA: 59s - loss: -0.6224 - dice_coef: 0.9457 
36/60 [=================>............] - ETA: 57s - loss: -0.6226 - dice_coef: 0.9456
37/60 [=================>............] - ETA: 54s - loss: -0.6228 - dice_coef: 0.9456
38/60 [==================>...........] - ETA: 52s - loss: -0.6231 - dice_coef: 0.9454
39/60 [==================>...........] - ETA: 50s - loss: -0.6228 - dice_coef: 0.9453
40/60 [===================>..........] - ETA: 47s - loss: -0.6231 - dice_coef: 0.9454
41/60 [===================>..........] - ETA: 45s - loss: -0.6232 - dice_coef: 0.9455
42/60 [====================>.........] - ETA: 42s - loss: -0.6234 - dice_coef: 0.9456
43/60 [====================>.........] - ETA: 40s - loss: -0.6235 - dice_coef: 0.9457
44/60 [=====================>........] - ETA: 38s - loss: -0.6237 - dice_coef: 0.9455
45/60 [=====================>........] - ETA: 35s - loss: -0.6237 - dice_coef: 0.9456
46/60 [======================>.......] - ETA: 33s - loss: -0.6238 - dice_coef: 0.9456
47/60 [======================>.......] - ETA: 30s - loss: -0.6238 - dice_coef: 0.9456
48/60 [=======================>......] - ETA: 28s - loss: -0.6243 - dice_coef: 0.9454
49/60 [=======================>......] - ETA: 26s - loss: -0.6241 - dice_coef: 0.9452
50/60 [========================>.....] - ETA: 23s - loss: -0.6239 - dice_coef: 0.9451
51/60 [========================>.....] - ETA: 21s - loss: -0.6240 - dice_coef: 0.9451
52/60 [=========================>....] - ETA: 19s - loss: -0.6242 - dice_coef: 0.9452
53/60 [=========================>....] - ETA: 16s - loss: -0.6242 - dice_coef: 0.9451
54/60 [==========================>...] - ETA: 14s - loss: -0.6245 - dice_coef: 0.9452
55/60 [==========================>...] - ETA: 11s - loss: -0.6250 - dice_coef: 0.9452
56/60 [===========================>..] - ETA: 9s - loss: -0.6249 - dice_coef: 0.9453 
57/60 [===========================>..] - ETA: 7s - loss: -0.6251 - dice_coef: 0.9454
58/60 [============================>.] - ETA: 4s - loss: -0.6251 - dice_coef: 0.9454
59/60 [============================>.] - ETA: 2s - loss: -0.6252 - dice_coef: 0.9454
60/60 [==============================] - 145s 2s/step - loss: -0.6256 - dice_coef: 0.9454 - val_loss: -0.6446 - val_dice_coef: 0.9580

Epoch 00008: loss improved from -0.61972 to -0.62561, saving model to unet_brain.h5
Epoch 9/10

 1/60 [..............................] - ETA: 2:21 - loss: -0.6423 - dice_coef: 0.9517
 2/60 [>.............................] - ETA: 2:18 - loss: -0.6311 - dice_coef: 0.9506
 3/60 [>.............................] - ETA: 2:16 - loss: -0.6270 - dice_coef: 0.9478
 4/60 [=>............................] - ETA: 2:13 - loss: -0.6281 - dice_coef: 0.9477
 5/60 [=>............................] - ETA: 2:11 - loss: -0.6313 - dice_coef: 0.9487
 6/60 [==>...........................] - ETA: 2:08 - loss: -0.6299 - dice_coef: 0.9488
 7/60 [==>...........................] - ETA: 2:06 - loss: -0.6306 - dice_coef: 0.9473
 8/60 [===>..........................] - ETA: 2:03 - loss: -0.6303 - dice_coef: 0.9465
 9/60 [===>..........................] - ETA: 2:01 - loss: -0.6292 - dice_coef: 0.9460
10/60 [====>.........................] - ETA: 1:59 - loss: -0.6305 - dice_coef: 0.9465
11/60 [====>.........................] - ETA: 1:56 - loss: -0.6293 - dice_coef: 0.9462
12/60 [=====>........................] - ETA: 1:54 - loss: -0.6298 - dice_coef: 0.9466
13/60 [=====>........................] - ETA: 1:52 - loss: -0.6303 - dice_coef: 0.9464
14/60 [======>.......................] - ETA: 1:49 - loss: -0.6303 - dice_coef: 0.9467
15/60 [======>.......................] - ETA: 1:47 - loss: -0.6298 - dice_coef: 0.9458
16/60 [=======>......................] - ETA: 1:44 - loss: -0.6296 - dice_coef: 0.9456
17/60 [=======>......................] - ETA: 1:42 - loss: -0.6306 - dice_coef: 0.9461
18/60 [========>.....................] - ETA: 1:40 - loss: -0.6306 - dice_coef: 0.9461
19/60 [========>.....................] - ETA: 1:37 - loss: -0.6311 - dice_coef: 0.9458
20/60 [=========>....................] - ETA: 1:35 - loss: -0.6307 - dice_coef: 0.9457
21/60 [=========>....................] - ETA: 1:32 - loss: -0.6307 - dice_coef: 0.9458
22/60 [==========>...................] - ETA: 1:30 - loss: -0.6312 - dice_coef: 0.9462
23/60 [==========>...................] - ETA: 1:28 - loss: -0.6320 - dice_coef: 0.9463
24/60 [===========>..................] - ETA: 1:25 - loss: -0.6318 - dice_coef: 0.9462
25/60 [===========>..................] - ETA: 1:23 - loss: -0.6313 - dice_coef: 0.9461
26/60 [============>.................] - ETA: 1:21 - loss: -0.6312 - dice_coef: 0.9459
27/60 [============>.................] - ETA: 1:18 - loss: -0.6310 - dice_coef: 0.9460
28/60 [=============>................] - ETA: 1:16 - loss: -0.6311 - dice_coef: 0.9462
29/60 [=============>................] - ETA: 1:13 - loss: -0.6312 - dice_coef: 0.9463
30/60 [==============>...............] - ETA: 1:11 - loss: -0.6313 - dice_coef: 0.9463
31/60 [==============>...............] - ETA: 1:09 - loss: -0.6324 - dice_coef: 0.9466
32/60 [===============>..............] - ETA: 1:06 - loss: -0.6324 - dice_coef: 0.9467
33/60 [===============>..............] - ETA: 1:04 - loss: -0.6328 - dice_coef: 0.9466
34/60 [================>.............] - ETA: 1:01 - loss: -0.6328 - dice_coef: 0.9465
35/60 [================>.............] - ETA: 59s - loss: -0.6326 - dice_coef: 0.9465 
36/60 [=================>............] - ETA: 57s - loss: -0.6329 - dice_coef: 0.9466
37/60 [=================>............] - ETA: 54s - loss: -0.6331 - dice_coef: 0.9467
38/60 [==================>...........] - ETA: 52s - loss: -0.6330 - dice_coef: 0.9465
39/60 [==================>...........] - ETA: 50s - loss: -0.6330 - dice_coef: 0.9464
40/60 [===================>..........] - ETA: 47s - loss: -0.6330 - dice_coef: 0.9466
41/60 [===================>..........] - ETA: 45s - loss: -0.6333 - dice_coef: 0.9466
42/60 [====================>.........] - ETA: 42s - loss: -0.6337 - dice_coef: 0.9465
43/60 [====================>.........] - ETA: 40s - loss: -0.6339 - dice_coef: 0.9466
44/60 [=====================>........] - ETA: 38s - loss: -0.6339 - dice_coef: 0.9467
45/60 [=====================>........] - ETA: 35s - loss: -0.6339 - dice_coef: 0.9467
46/60 [======================>.......] - ETA: 33s - loss: -0.6344 - dice_coef: 0.9467
47/60 [======================>.......] - ETA: 30s - loss: -0.6344 - dice_coef: 0.9467
48/60 [=======================>......] - ETA: 28s - loss: -0.6343 - dice_coef: 0.9466
49/60 [=======================>......] - ETA: 26s - loss: -0.6343 - dice_coef: 0.9466
50/60 [========================>.....] - ETA: 23s - loss: -0.6345 - dice_coef: 0.9467
51/60 [========================>.....] - ETA: 21s - loss: -0.6344 - dice_coef: 0.9469
52/60 [=========================>....] - ETA: 19s - loss: -0.6345 - dice_coef: 0.9468
53/60 [=========================>....] - ETA: 16s - loss: -0.6345 - dice_coef: 0.9467
54/60 [==========================>...] - ETA: 14s - loss: -0.6342 - dice_coef: 0.9466
55/60 [==========================>...] - ETA: 11s - loss: -0.6339 - dice_coef: 0.9468
56/60 [===========================>..] - ETA: 9s - loss: -0.6340 - dice_coef: 0.9467 2018-04-25 07:02:31.952585: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 3.38GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
2018-04-25 07:02:31.952638: W tensorflow/stream_executor/cuda/cuda_dnn.cc:3355] 

57/60 [===========================>..] - ETA: 7s - loss: -0.6338 - dice_coef: 0.9466
58/60 [============================>.] - ETA: 4s - loss: -0.6342 - dice_coef: 0.9467
59/60 [============================>.] - ETA: 2s - loss: -0.6345 - dice_coef: 0.9469
60/60 [==============================] - 146s 2s/step - loss: -0.6345 - dice_coef: 0.9468 - val_loss: -0.6449 - val_dice_coef: 0.9492

Epoch 00009: loss improved from -0.62561 to -0.63454, saving model to unet_brain.h5
Epoch 10/10

 1/60 [..............................] - ETA: 2:19 - loss: -0.6421 - dice_coef: 0.9454
 2/60 [>.............................] - ETA: 2:17 - loss: -0.6394 - dice_coef: 0.9439
 3/60 [>.............................] - ETA: 2:15 - loss: -0.6352 - dice_coef: 0.9442
 4/60 [=>............................] - ETA: 2:13 - loss: -0.6381 - dice_coef: 0.9459
 5/60 [=>............................] - ETA: 2:10 - loss: -0.6417 - dice_coef: 0.9479
 6/60 [==>...........................] - ETA: 2:08 - loss: -0.6397 - dice_coef: 0.9485
 7/60 [==>...........................] - ETA: 2:05 - loss: -0.6404 - dice_coef: 0.9489
 8/60 [===>..........................] - ETA: 2:03 - loss: -0.6401 - dice_coef: 0.9490
 9/60 [===>..........................] - ETA: 2:01 - loss: -0.6390 - dice_coef: 0.9485
10/60 [====>.........................] - ETA: 1:58 - loss: -0.6397 - dice_coef: 0.9482
11/60 [====>.........................] - ETA: 1:56 - loss: -0.6396 - dice_coef: 0.9483
12/60 [=====>........................] - ETA: 1:54 - loss: -0.6398 - dice_coef: 0.9479
13/60 [=====>........................] - ETA: 1:51 - loss: -0.6411 - dice_coef: 0.9486
14/60 [======>.......................] - ETA: 1:49 - loss: -0.6416 - dice_coef: 0.9488
15/60 [======>.......................] - ETA: 1:47 - loss: -0.6408 - dice_coef: 0.9482
16/60 [=======>......................] - ETA: 1:44 - loss: -0.6400 - dice_coef: 0.9476
17/60 [=======>......................] - ETA: 1:42 - loss: -0.6393 - dice_coef: 0.9475
18/60 [========>.....................] - ETA: 1:39 - loss: -0.6394 - dice_coef: 0.9478
19/60 [========>.....................] - ETA: 1:37 - loss: -0.6396 - dice_coef: 0.9476
20/60 [=========>....................] - ETA: 1:35 - loss: -0.6401 - dice_coef: 0.9476
21/60 [=========>....................] - ETA: 1:32 - loss: -0.6402 - dice_coef: 0.9479
22/60 [==========>...................] - ETA: 1:30 - loss: -0.6413 - dice_coef: 0.9477
23/60 [==========>...................] - ETA: 1:28 - loss: -0.6413 - dice_coef: 0.94822018-04-25 07:03:39.303213: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 3.38GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
2018-04-25 07:03:39.303267: W tensorflow/stream_executor/cuda/cuda_dnn.cc:3355] 

24/60 [===========>..................] - ETA: 1:25 - loss: -0.6415 - dice_coef: 0.9482
25/60 [===========>..................] - ETA: 1:23 - loss: -0.6416 - dice_coef: 0.9482
26/60 [============>.................] - ETA: 1:21 - loss: -0.6414 - dice_coef: 0.9483
27/60 [============>.................] - ETA: 1:18 - loss: -0.6413 - dice_coef: 0.9483
28/60 [=============>................] - ETA: 1:16 - loss: -0.6414 - dice_coef: 0.9481
29/60 [=============>................] - ETA: 1:13 - loss: -0.6418 - dice_coef: 0.9480
30/60 [==============>...............] - ETA: 1:11 - loss: -0.6416 - dice_coef: 0.9478
31/60 [==============>...............] - ETA: 1:09 - loss: -0.6418 - dice_coef: 0.9479
32/60 [===============>..............] - ETA: 1:06 - loss: -0.6415 - dice_coef: 0.9477
33/60 [===============>..............] - ETA: 1:04 - loss: -0.6416 - dice_coef: 0.9478
34/60 [================>.............] - ETA: 1:02 - loss: -0.6414 - dice_coef: 0.9477
35/60 [================>.............] - ETA: 59s - loss: -0.6409 - dice_coef: 0.9475 
36/60 [=================>............] - ETA: 57s - loss: -0.6408 - dice_coef: 0.9476
37/60 [=================>............] - ETA: 54s - loss: -0.6408 - dice_coef: 0.9478
38/60 [==================>...........] - ETA: 52s - loss: -0.6408 - dice_coef: 0.9478
39/60 [==================>...........] - ETA: 50s - loss: -0.6412 - dice_coef: 0.9477
40/60 [===================>..........] - ETA: 47s - loss: -0.6414 - dice_coef: 0.9478
41/60 [===================>..........] - ETA: 45s - loss: -0.6416 - dice_coef: 0.9480
42/60 [====================>.........] - ETA: 42s - loss: -0.6414 - dice_coef: 0.9478
43/60 [====================>.........] - ETA: 40s - loss: -0.6411 - dice_coef: 0.9477
44/60 [=====================>........] - ETA: 38s - loss: -0.6411 - dice_coef: 0.9478
45/60 [=====================>........] - ETA: 35s - loss: -0.6416 - dice_coef: 0.9479
46/60 [======================>.......] - ETA: 33s - loss: -0.6417 - dice_coef: 0.9481
47/60 [======================>.......] - ETA: 30s - loss: -0.6421 - dice_coef: 0.9481
48/60 [=======================>......] - ETA: 28s - loss: -0.6422 - dice_coef: 0.9482
49/60 [=======================>......] - ETA: 26s - loss: -0.6425 - dice_coef: 0.9482
50/60 [========================>.....] - ETA: 23s - loss: -0.6426 - dice_coef: 0.9482
51/60 [========================>.....] - ETA: 21s - loss: -0.6429 - dice_coef: 0.9481
52/60 [=========================>....] - ETA: 19s - loss: -0.6428 - dice_coef: 0.9482
53/60 [=========================>....] - ETA: 16s - loss: -0.6427 - dice_coef: 0.9482
54/60 [==========================>...] - ETA: 14s - loss: -0.6427 - dice_coef: 0.9480
55/60 [==========================>...] - ETA: 11s - loss: -0.6423 - dice_coef: 0.9481
56/60 [===========================>..] - ETA: 9s - loss: -0.6426 - dice_coef: 0.9481 
57/60 [===========================>..] - ETA: 7s - loss: -0.6424 - dice_coef: 0.94822018-04-25 07:05:00.432875: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 3.38GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
2018-04-25 07:05:00.432932: W tensorflow/stream_executor/cuda/cuda_dnn.cc:3355] 

58/60 [============================>.] - ETA: 4s - loss: -0.6422 - dice_coef: 0.9483
59/60 [============================>.] - ETA: 2s - loss: -0.6418 - dice_coef: 0.9482
60/60 [==============================] - 146s 2s/step - loss: -0.6419 - dice_coef: 0.9481 - val_loss: -0.6525 - val_dice_coef: 0.9617

Epoch 00010: loss improved from -0.63454 to -0.64195, saving model to unet_brain.h5
------------------------------
Start doing prediction on test data...
Traceback (most recent call last):
  File "uNet.py", line 244, in <module>
    dic = predict_brain(myunet.model, 'unet_brain.h5')
  File "uNet.py", line 186, in predict_brain
    dic = dice_coef_2class(img_preds, segs)
NameError: global name 'img_preds' is not defined
